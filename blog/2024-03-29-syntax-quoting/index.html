<!DOCTYPE html><meta charset="utf-8"><meta content="width=device-width,initial-scale=1"name="viewport"><link href="/css/main.css"rel="stylesheet"><link href="/blog/feed.xml"rel="alternate"title="RSS Feed"type="application/atom+xml"><link href="https://fonts.googleapis.com"rel="preconnect"><link crossorigin href="https://fonts.gstatic.com"rel="preconnect"><link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&amp;display=swap"rel="stylesheet"><title>jank development update - Syntax quoting!</title><meta content="jank development update - Syntax quoting!"property="og:title"><meta content="jank now supports syntax quoting, more reader macros, transients, and, and, and other things!"property="og:description"><meta content="https://jank-lang.org/img/logo-text-dark.png"property="og:image"><link href="/img/favicon/apple-touch-icon.png"rel="apple-touch-icon"sizes="180x180"><link href="/img/favicon/32.png"rel="icon"sizes="32x32"type="image/png"><link href="/img/favicon/16.png"rel="icon"sizes="16x16"type="image/png"><link href="/img/favicon/site.webmanifest"rel="manifest"><style>.gg-bulb{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:16px;height:16px;border:2px solid;border-bottom-color:transparent;border-radius:100px}.gg-bulb::after,.gg-bulb::before{content:"";display:block;box-sizing:border-box;position:absolute}.gg-bulb::before{border-top:0;border-bottom-left-radius:18px;border-bottom-right-radius:18px;top:10px;border-bottom:2px solid transparent;box-shadow:0 5px 0 -2px,inset 2px 0 0 0,inset -2px 0 0 0,inset 0 -4px 0 -2px;width:8px;height:8px;left:2px}.gg-bulb::after{width:12px;height:2px;border-left:3px solid;border-right:3px solid;border-radius:2px;bottom:0;left:0}.gg-check-o{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:22px;height:22px;border:2px solid;border-radius:100px}.gg-check-o::after{content:"";display:block;box-sizing:border-box;position:absolute;left:3px;top:-1px;width:6px;height:10px;border-color:currentColor;border-width:0 2px 2px 0;border-style:solid;transform-origin:bottom left;transform:rotate(45deg)}.gg-comment{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:20px;height:16px;border:2px solid;border-bottom:0;box-shadow:-6px 8px 0 -6px,6px 8px 0 -6px}.gg-comment::after,.gg-comment::before{content:"";display:block;box-sizing:border-box;position:absolute;width:8px}.gg-comment::before{border:2px solid;border-top-color:transparent;border-bottom-left-radius:20px;right:4px;bottom:-6px;height:6px}.gg-comment::after{height:2px;background:currentColor;box-shadow:0 4px 0 0;left:4px;top:4px}.gg-git-fork{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:2px;height:14px;background:currentColor}.gg-git-fork::after,.gg-git-fork::before{content:"";display:block;box-sizing:border-box;position:absolute}.gg-git-fork::before{border-right:2px solid;border-bottom:2px solid;border-bottom-right-radius:4px;bottom:4px;width:8px;height:6px;left:0}.gg-git-fork::after{width:4px;height:4px;background:currentColor;box-shadow:0 12px 0 0,6px 2px 0 0;border-radius:100%;left:-1px;top:-1px}.gg-heart,.gg-heart::after{border:2px solid;border-top-left-radius:100px;border-top-right-radius:100px;width:10px;height:8px;border-bottom:0}.gg-heart{box-sizing:border-box;position:relative;transform:translate(calc(-10px / 2 * var(--ggs,1)),calc(-6px / 2 * var(--ggs,1))) rotate(-45deg) scale(var(--ggs,1));display:block}.gg-heart::after,.gg-heart::before{content:"";display:block;box-sizing:border-box;position:absolute}.gg-heart::after{right:-9px;transform:rotate(90deg);top:5px}.gg-heart::before{width:11px;height:11px;border-left:2px solid;border-bottom:2px solid;left:-2px;top:3px}.gg-home{background:linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 0 bottom/4px 2px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat right bottom/4px 2px;box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:18px;height:14px;border:2px solid;border-top:0;border-bottom:0;border-top-right-radius:3px;border-top-left-radius:3px;border-bottom-right-radius:0;border-bottom-left-radius:0;margin-bottom:-2px}.gg-home::after,.gg-home::before{content:"";display:block;box-sizing:border-box;position:absolute}.gg-home::before{border-top:2px solid;border-left:2px solid;border-top-left-radius:4px;transform:rotate(45deg);top:-5px;border-radius:3px;width:14px;height:14px;left:0}.gg-home::after{width:8px;height:10px;border:2px solid;border-radius:100px;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:0;left:3px;bottom:0}.gg-info{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:20px;height:20px;border:2px solid;border-radius:40px}.gg-info::after,.gg-info::before{content:"";display:block;box-sizing:border-box;position:absolute;border-radius:3px;width:2px;background:currentColor;left:7px}.gg-info::after{bottom:2px;height:8px}.gg-info::before{height:2px;top:2px}.gg-link{box-sizing:border-box;position:relative;display:block;transform:rotate(-45deg) scale(var(--ggs,1));width:8px;height:2px;background:currentColor;border-radius:4px}.gg-link::after,.gg-link::before{content:"";display:block;box-sizing:border-box;position:absolute;border-radius:3px;width:8px;height:10px;border:2px solid;top:-4px}.gg-link::before{border-right:0;border-top-left-radius:40px;border-bottom-left-radius:40px;left:-6px}.gg-link::after{border-left:0;border-top-right-radius:40px;border-bottom-right-radius:40px;right:-6px}.gg-list{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:22px;height:20px;border:2px solid;border-radius:3px}.gg-list::after,.gg-list::before{content:"";display:block;box-sizing:border-box;position:absolute;width:2px;height:2px;background:currentColor;top:3px;left:3px;box-shadow:0 4px 0,0 8px 0}.gg-list::after{border-radius:3px;width:8px;left:7px}.gg-math-minus{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:16px;height:2px;background:currentColor;border-radius:10px}.gg-slack{position:relative;box-sizing:border-box;transform:scale(var(--ggs,1));display:block;width:20px;height:20px;background:linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 7px 2px/2px 2px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 15px 7px/2px 2px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 2px 10px/2px 2px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 10px 15px/2px 2px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 10px 2px/4px 5px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 5px 12px/4px 5px}.gg-slack::after,.gg-slack::before{background:currentColor;content:"";position:absolute;box-sizing:border-box;display:block;height:4px;border-radius:22px}.gg-slack::before{width:9px;top:5px;box-shadow:10px 5px 0}.gg-slack::after{width:4px;left:5px;box-shadow:-5px 10px 0,0 10px 0,0 15px 0,5px 15px 0,5px 5px 0,5px 0 0,10px 5px 0}.gg-sync{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));border-radius:40px;border:2px solid;margin:1px;border-left-color:transparent;border-right-color:transparent;width:18px;height:18px}.gg-sync::after,.gg-sync::before{content:"";display:block;box-sizing:border-box;position:absolute;width:0;height:0;border-top:4px solid transparent;border-bottom:4px solid transparent;transform:rotate(-45deg)}.gg-sync::before{border-left:6px solid;bottom:-1px;right:-3px}.gg-sync::after{border-right:6px solid;top:-1px;left:-3px}.gg-twitter{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:20px;height:20px}.gg-twitter::after,.gg-twitter::before{content:"";display:block;position:absolute;box-sizing:border-box;left:4px}.gg-twitter::before{width:9px;height:14px;border-left:4px solid;border-bottom:4px solid;border-bottom-left-radius:6px;background:linear-gradient(to left,currentColor 12px,transparent 0) no-repeat center 2px/10px 4px;top:4px}.gg-twitter::after{width:4px;height:4px;background:currentColor;border-radius:20px;top:2px;box-shadow:7px 4px 0,7px 12px 0}</style><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),(()=>{var a="//matomo.jeaye.com/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","1"]);var e=(p=document).createElement("script"),p=p.getElementsByTagName("script")[0];e.async=!0,e.src=a+"matomo.js",p.parentNode.insertBefore(e,p)})()</script><div><div><nav class="navbar is-primary"><div class="container"><div class="navbar-brand"><a class="navbar-item title has-text-white"href="/blog"style="font-family:Comfortaa"><img src="/img/logo-transparent.png"style="margin-right:15px">jank blog</a></div><div class="navbar-menu is-active"><div class="navbar-end has-text-weight-semibold"><a class="navbar-item has-text-white"href="/"><span class="icon mr-1"><i class="gg-home"></i></span><strong>Home</strong></a><a class="navbar-item has-text-white"href="/blog"><span class="icon mr-1"><i class="gg-comment"></i></span><strong>Blog</strong></a><a class="navbar-item has-text-white"href="https://github.com/sponsors/jeaye"><span class="icon mr-1"style="color:#c96198"><i class="gg-heart"></i></span><strong>Sponsor</strong></a><a class="navbar-item has-text-white"href="https://github.com/jank-lang/jank"><span class="icon mr-1"><i class="gg-git-fork"></i></span><strong>Github</strong></a><a class="navbar-item has-text-white"href="https://clojurians.slack.com/archives/C03SRH97FDK"><span class="icon mr-1"><i class="gg-slack"></i></span>Slack</a><a class="navbar-item has-text-white"href="https://twitter.com/jeayewilkerson"><span class="icon mr-1"><i class="gg-twitter"></i></span>Twitter</a></div></div></div></nav></div><section class="section"><div class="container blog-container"><span class="is-size-1">jank development update - Syntax quoting!</span><div class="is-size-6 has-text-weight-light">Mar 29, 2024 · <a class="has-text-weight-normal"href="https://github.com/jeaye">Jeaye Wilkerson</a></div><hr><div class="content"><p>Oh, hey folks. I was just wrapping up this macro I was writing. One moment.<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">defmacro</span><span style="color:#f8f8f2"> if-some </span><span style="color:#fd971f">[</span><span style="color:#f8f8f2">bindings then else</span><span style="color:#fd971f">]</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#a6e22e">assert-macro-args</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">vector?</span><span style="color:#f8f8f2"> bindings</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#e6db74">                     &quot;a vector for its binding&quot;</span></span>
<span class="line"><span style="color:#fd971f">                     (</span><span style="color:#a6e22e">=</span><span style="color:#ae81ff"> 2</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">count</span><span style="color:#f8f8f2"> bindings</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#e6db74">                     &quot;exactly 2 forms in binding vector&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">form </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">get</span><span style="color:#f8f8f2"> bindings </span><span style="color:#ae81ff">0</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#f8f8f2">        pred </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">get</span><span style="color:#f8f8f2"> bindings </span><span style="color:#ae81ff">1</span><span style="color:#fd971f">)]</span></span>
<span class="line"><span style="color:#fd971f">    `(</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">temp# ~pred</span><span style="color:#fd971f">]</span></span>
<span class="line"><span style="color:#fd971f">       (</span><span style="color:#fb4934;font-weight:700">if</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">nil?</span><span style="color:#f8f8f2"> temp#</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#f8f8f2">         ~else</span></span>
<span class="line"><span style="color:#fd971f">         (</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">~form temp#</span><span style="color:#fd971f">]</span></span>
<span class="line"><span style="color:#f8f8f2">           ~then</span><span style="color:#fd971f">)))))</span></span></code></pre><p><em>&quot;Does all of that work in jank?&quot;</em> I hear you asking yourself. Yes! Indeed it does. Since my <a href="https://jank-lang.org/blog/2024-02-23-bindings/">last update</a>, which added dynamic bindings, meta hints, and initial reader macros, I've finished up syntax quoting support, including gensym support, unquoting, and unquote splicing. We might as well see all of this working in jank's REPL CLI.<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#f8f8f2">❯ jank repl</span></span>
<span class="line"><span style="color:#f8f8f2">&gt; </span><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">defmacro</span><span style="color:#f8f8f2"> if-some </span><span style="color:#fd971f">[</span><span style="color:#f8f8f2">bindings then else</span><span style="color:#fd971f">]</span></span>
<span class="line"><span style="color:#fd971f">    (</span><span style="color:#a6e22e">assert-macro-args</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">vector?</span><span style="color:#f8f8f2"> bindings</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#e6db74">                       &quot;a vector for its binding&quot;</span></span>
<span class="line"><span style="color:#fd971f">                       (</span><span style="color:#a6e22e">=</span><span style="color:#ae81ff"> 2</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">count</span><span style="color:#f8f8f2"> bindings</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#e6db74">                       &quot;exactly 2 forms in binding vector&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#fd971f">    (</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">form </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">get</span><span style="color:#f8f8f2"> bindings </span><span style="color:#ae81ff">0</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#f8f8f2">          pred </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">get</span><span style="color:#f8f8f2"> bindings </span><span style="color:#ae81ff">1</span><span style="color:#fd971f">)]</span></span>
<span class="line"><span style="color:#fd971f">      `(</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">temp# ~pred</span><span style="color:#fd971f">]</span></span>
<span class="line"><span style="color:#fd971f">         (</span><span style="color:#fb4934;font-weight:700">if</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">nil?</span><span style="color:#f8f8f2"> temp#</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#f8f8f2">           ~else</span></span>
<span class="line"><span style="color:#fd971f">           (</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">~form temp#</span><span style="color:#fd971f">]</span></span>
<span class="line"><span style="color:#f8f8f2">             ~then</span><span style="color:#fd971f">)))))</span></span>
<span class="line"><span style="color:#f8f8f2">#'clojure.core/if-some</span></span>
<span class="line"><span style="color:#f8f8f2">&gt; </span><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">if-some</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">x </span><span style="color:#ae81ff">123</span><span style="color:#fd971f">]</span></span>
<span class="line"><span style="color:#fd971f">    (</span><span style="color:#a6e22e">str</span><span style="color:#e6db74"> &quot;some &quot;</span><span style="color:#f8f8f2"> x</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#e6db74">    &quot;none&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#e6db74">&quot;some 123&quot;</span></span>
<span class="line"><span style="color:#f8f8f2">&gt; </span><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">if-some</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">x </span><span style="color:#ae81ff">nil</span><span style="color:#fd971f">]</span></span>
<span class="line"><span style="color:#fd971f">    (</span><span style="color:#a6e22e">str</span><span style="color:#e6db74"> &quot;some &quot;</span><span style="color:#f8f8f2"> x</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#e6db74">    &quot;none&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#e6db74">&quot;none&quot;</span></span>
<span class="line"><span style="color:#f8f8f2">&gt;</span></span></code></pre><h2>New interpolation syntax</h2><p>Some of the early feedback I had for jank's inline C++ support is that the interpolation syntax we use is different from what ClojureScript uses. Turns out there's no reason to be different, aside from jank needing some more work, so jank has been improved to support the new <code>~{}</code> syntax. If you're not familiar, inline C++ in jank looks like this:<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">defn</span><span style="color:#f8f8f2"> sleep </span><span style="color:#fd971f">[</span><span style="color:#f8f8f2">ms</span><span style="color:#fd971f">]</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">ms </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">int</span><span style="color:#f8f8f2"> ms</span><span style="color:#fd971f">)]</span></span>
<span class="line"><span style="color:#88846f">    ; A special ~{ } syntax can be used from inline C++ to interpolate</span></span>
<span class="line"><span style="color:#88846f">    ; back into jank code.</span></span>
<span class="line"><span style="color:#fd971f">    (</span><span style="color:#a6e22e">native/raw</span><span style="color:#e6db74"> &quot;auto const duration(std::chrono::milliseconds(~{ ms }-&gt;data));</span></span>
<span class="line"><span style="color:#e6db74">                 std::this_thread::sleep_for(duration);&quot;</span><span style="color:#fd971f">)))</span></span></code></pre><h2>More reader macros</h2><p>Aside from that, reader macro support has been extended to include shorthand <code>#()</code> anonymous functions as well as <code>#'v</code> var quoting. The only reader macro not yet implemented is <code>#&quot;&quot;</code> for regex. All of that concludes what I had aimed to accomplish for my quarter, and then some. It doesn't stop there, though.<h2>New logo</h2><p>I'm wonderfully pleased to announce that jank now has a logo! The logo was designed by <a href="https://github.com/jaidetree">jaide</a>, who was graciously patient with me and a joy to work with through the various iterations. With this logo, we're capturing C++ on one side, Lisp on the other, and yet a functional core.<p><figure><img src="/img/blog/2024-03-29-syntax-quoting/logo.png"width="50%"></figure><p><h2>Transients</h2><p>Back to code. In truth, there's more work going on. A lovely man named <a href="https://github.com/Samy-33">Saket</a> has been helping me fill out jank's transient functionality, which now includes array maps, vectors, and sets, as well as the corresponding <code>clojure.core</code> functions. This is not the first time I've brought up Saket, since he also implemented the initial lein-jank plugin. Let's take a look at that.<h2>lein-jank</h2><p>This plugin isn't ready for prime time yet, but it's a good proof of concept that jank can work with leiningen's classpaths and it's a good testing ground for multi-file projects. jank will be adding AOT compilation soon and this lein-jank plugin will be the first place new features will land. As a brief demonstration of where it is today, take a look at this session.<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#f8f8f2">❯ cat project.clj</span></span>
<span class="line"><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">defproject</span><span style="color:#f8f8f2"> findenv </span><span style="color:#e6db74">&quot;0.1.0-SNAPSHOT&quot;</span></span>
<span class="line"><span style="color:#819aff">  :dependencies</span><span style="color:#fd971f"> [[</span><span style="color:#f8f8f2">org.clojure/clojure </span><span style="color:#e6db74">&quot;1.11.1&quot;</span><span style="color:#fd971f">]]</span></span>
<span class="line"><span style="color:#819aff">  :plugins</span><span style="color:#fd971f"> [[</span><span style="color:#f8f8f2">lein-jank </span><span style="color:#e6db74">&quot;0.0.1-SNAPSHOT&quot;</span><span style="color:#fd971f">]]</span></span>
<span class="line"><span style="color:#819aff">  :jank</span><span style="color:#fd971f"> {</span><span style="color:#819aff">:main</span><span style="color:#f8f8f2"> findenv.core</span><span style="color:#fd971f">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f8f8f2">❯ cat src/findenv/core.jank</span></span>
<span class="line"><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">ns</span><span style="color:#f8f8f2"> findenv.core</span><span style="color:#fd971f">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">defn</span><span style="color:#f8f8f2"> -main </span><span style="color:#fd971f">[</span><span style="color:#f8f8f2">&amp; args</span><span style="color:#fd971f">]</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">env-var </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">first</span><span style="color:#f8f8f2"> args</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#88846f">        ; Call through into native land to look up the var.</span></span>
<span class="line"><span style="color:#f8f8f2">        env-val </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">or</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">native/raw</span><span style="color:#e6db74"> &quot;auto const str(runtime::detail::to_string(~{ env-var }));</span></span>
<span class="line"><span style="color:#e6db74">                                 __value = make_box(std::getenv(str.c_str()));&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#e6db74">                    &quot;var not found&quot;</span><span style="color:#fd971f">)]</span></span>
<span class="line"><span style="color:#fd971f">    (</span><span style="color:#a6e22e">println</span><span style="color:#f8f8f2"> env-val</span><span style="color:#fd971f">)))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f8f8f2">❯ export FINDME=</span><span style="color:#e6db74">&quot;found me!&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f8f8f2">❯ lein jank run FINDME</span></span>
<span class="line"><span style="color:#f8f8f2">found me!</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f8f8f2">❯ lein jank run YOUWONTFINDME</span></span>
<span class="line"><span style="color:#f8f8f2">var not found</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f8f8f2">❯ lein jank run LC_ALL</span></span>
<span class="line"><span style="color:#f8f8f2">en_US.UTF-8</span></span></code></pre><h2>Migration from Cling to clang-repl</h2><p>Lastly, I've been working on migrating jank to use the upstream LLVM version of Cling, called clang-repl. The key benefit here is that we'd no longer need to compile our own Cling/Clang/LLVM stack in order to build jank and we can distribute jank to use each distro's normal LLVM package, rather than its own. On top of that, future work is happening more on clang-repl than on Cling, so it has recent support for loading pre-compiled C++20 modules, for example. That would greatly improve jank's startup performance, since Cling doesn't allow us to load pre-compiled modules at this point.<p>Work here is ongoing and there are some bugs that I have identified in clang-repl which need to be fixed before jank can fully make the switch. I'll keep you all updated!<h2>Would you like to join in?</h2><ol><li>Join the community on <a href="https://clojurians.slack.com/archives/C03SRH97FDK">Slack</a><li>Join the design discussions or pick up a ticket on <a href="https://github.com/jank-lang/jank">GitHub</a><li>Considering becoming a <a href="https://github.com/sponsors/jeaye">Sponsor</a> <span class="icon mr-1"style="color:#c96198"><i class="gg-heart"></i></span><li><strong>Hire me full-time to work on jank!</strong></ol></div></div></section></div><footer class="footer"><div class="container"><div class="columns has-text-centered"></div><div class="container has-text-centered"><div class="content is-small"><p>© 2025 Jeaye Wilkerson | All rights reserved.</div></div></div></footer><noscript><p><img src="//matomo.jeaye.com/matomo.php?idsite=1&amp;rec=1"style="border:0"alt=""></p></noscript><script>for(var coll=document.getElementsByClassName("collapsible"),i=0;i<coll.length;i++)coll[i].addEventListener("click",function(){this.classList.toggle("active");var l=this.nextElementSibling;"block"===l.style.display?l.style.display="none":l.style.display="block"})</script>