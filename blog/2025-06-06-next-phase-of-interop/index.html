<!DOCTYPE html><meta charset="utf-8"><meta content="width=device-width,initial-scale=1"name="viewport"><link href="/css/main.css"rel="stylesheet"><link href="/blog/feed.xml"rel="alternate"title="RSS Feed"type="application/atom+xml"><title>The next phase of jank's C++ interop</title><meta content="The next phase of jank&apos;s C++ interop"property="og:title"><meta content="C++! Clojure! Magic! Dragons! Read all about it!"property="og:description"><meta content="https://jank-lang.org/img/logo-text-dark.png"property="og:image"><link href="/img/favicon/apple-touch-icon.png"rel="apple-touch-icon"sizes="180x180"><link href="/img/favicon/32.png"rel="icon"sizes="32x32"type="image/png"><link href="/img/favicon/16.png"rel="icon"sizes="16x16"type="image/png"><link href="/img/favicon/site.webmanifest"rel="manifest"><style>.gg-bulb{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:16px;height:16px;border:2px solid;border-bottom-color:transparent;border-radius:100px}.gg-bulb::after,.gg-bulb::before{content:"";display:block;box-sizing:border-box;position:absolute}.gg-bulb::before{border-top:0;border-bottom-left-radius:18px;border-bottom-right-radius:18px;top:10px;border-bottom:2px solid transparent;box-shadow:0 5px 0 -2px,inset 2px 0 0 0,inset -2px 0 0 0,inset 0 -4px 0 -2px;width:8px;height:8px;left:2px}.gg-bulb::after{width:12px;height:2px;border-left:3px solid;border-right:3px solid;border-radius:2px;bottom:0;left:0}.gg-check-o{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:22px;height:22px;border:2px solid;border-radius:100px}.gg-check-o::after{content:"";display:block;box-sizing:border-box;position:absolute;left:3px;top:-1px;width:6px;height:10px;border-color:currentColor;border-width:0 2px 2px 0;border-style:solid;transform-origin:bottom left;transform:rotate(45deg)}.gg-comment{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:20px;height:16px;border:2px solid;border-bottom:0;box-shadow:-6px 8px 0 -6px,6px 8px 0 -6px}.gg-comment::after,.gg-comment::before{content:"";display:block;box-sizing:border-box;position:absolute;width:8px}.gg-comment::before{border:2px solid;border-top-color:transparent;border-bottom-left-radius:20px;right:4px;bottom:-6px;height:6px}.gg-comment::after{height:2px;background:currentColor;box-shadow:0 4px 0 0;left:4px;top:4px}.gg-git-fork{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:2px;height:14px;background:currentColor}.gg-git-fork::after,.gg-git-fork::before{content:"";display:block;box-sizing:border-box;position:absolute}.gg-git-fork::before{border-right:2px solid;border-bottom:2px solid;border-bottom-right-radius:4px;bottom:4px;width:8px;height:6px;left:0}.gg-git-fork::after{width:4px;height:4px;background:currentColor;box-shadow:0 12px 0 0,6px 2px 0 0;border-radius:100%;left:-1px;top:-1px}.gg-heart,.gg-heart::after{border:2px solid;border-top-left-radius:100px;border-top-right-radius:100px;width:10px;height:8px;border-bottom:0}.gg-heart{box-sizing:border-box;position:relative;transform:translate(calc(-10px / 2 * var(--ggs,1)),calc(-6px / 2 * var(--ggs,1))) rotate(-45deg) scale(var(--ggs,1));display:block}.gg-heart::after,.gg-heart::before{content:"";display:block;box-sizing:border-box;position:absolute}.gg-heart::after{right:-9px;transform:rotate(90deg);top:5px}.gg-heart::before{width:11px;height:11px;border-left:2px solid;border-bottom:2px solid;left:-2px;top:3px}.gg-home{background:linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 0 bottom/4px 2px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat right bottom/4px 2px;box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:18px;height:14px;border:2px solid;border-top:0;border-bottom:0;border-top-right-radius:3px;border-top-left-radius:3px;border-bottom-right-radius:0;border-bottom-left-radius:0;margin-bottom:-2px}.gg-home::after,.gg-home::before{content:"";display:block;box-sizing:border-box;position:absolute}.gg-home::before{border-top:2px solid;border-left:2px solid;border-top-left-radius:4px;transform:rotate(45deg);top:-5px;border-radius:3px;width:14px;height:14px;left:0}.gg-home::after{width:8px;height:10px;border:2px solid;border-radius:100px;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:0;left:3px;bottom:0}.gg-info{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:20px;height:20px;border:2px solid;border-radius:40px}.gg-info::after,.gg-info::before{content:"";display:block;box-sizing:border-box;position:absolute;border-radius:3px;width:2px;background:currentColor;left:7px}.gg-info::after{bottom:2px;height:8px}.gg-info::before{height:2px;top:2px}.gg-link{box-sizing:border-box;position:relative;display:block;transform:rotate(-45deg) scale(var(--ggs,1));width:8px;height:2px;background:currentColor;border-radius:4px}.gg-link::after,.gg-link::before{content:"";display:block;box-sizing:border-box;position:absolute;border-radius:3px;width:8px;height:10px;border:2px solid;top:-4px}.gg-link::before{border-right:0;border-top-left-radius:40px;border-bottom-left-radius:40px;left:-6px}.gg-link::after{border-left:0;border-top-right-radius:40px;border-bottom-right-radius:40px;right:-6px}.gg-list{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:22px;height:20px;border:2px solid;border-radius:3px}.gg-list::after,.gg-list::before{content:"";display:block;box-sizing:border-box;position:absolute;width:2px;height:2px;background:currentColor;top:3px;left:3px;box-shadow:0 4px 0,0 8px 0}.gg-list::after{border-radius:3px;width:8px;left:7px}.gg-math-minus{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:16px;height:2px;background:currentColor;border-radius:10px}.gg-slack{position:relative;box-sizing:border-box;transform:scale(var(--ggs,1));display:block;width:20px;height:20px;background:linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 7px 2px/2px 2px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 15px 7px/2px 2px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 2px 10px/2px 2px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 10px 15px/2px 2px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 10px 2px/4px 5px,linear-gradient(to left,currentColor 5px,transparent 0) no-repeat 5px 12px/4px 5px}.gg-slack::after,.gg-slack::before{background:currentColor;content:"";position:absolute;box-sizing:border-box;display:block;height:4px;border-radius:22px}.gg-slack::before{width:9px;top:5px;box-shadow:10px 5px 0}.gg-slack::after{width:4px;left:5px;box-shadow:-5px 10px 0,0 10px 0,0 15px 0,5px 15px 0,5px 5px 0,5px 0 0,10px 5px 0}.gg-sync{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));border-radius:40px;border:2px solid;margin:1px;border-left-color:transparent;border-right-color:transparent;width:18px;height:18px}.gg-sync::after,.gg-sync::before{content:"";display:block;box-sizing:border-box;position:absolute;width:0;height:0;border-top:4px solid transparent;border-bottom:4px solid transparent;transform:rotate(-45deg)}.gg-sync::before{border-left:6px solid;bottom:-1px;right:-3px}.gg-sync::after{border-right:6px solid;top:-1px;left:-3px}.gg-twitter{box-sizing:border-box;position:relative;display:block;transform:scale(var(--ggs,1));width:20px;height:20px}.gg-twitter::after,.gg-twitter::before{content:"";display:block;position:absolute;box-sizing:border-box;left:4px}.gg-twitter::before{width:9px;height:14px;border-left:4px solid;border-bottom:4px solid;border-bottom-left-radius:6px;background:linear-gradient(to left,currentColor 12px,transparent 0) no-repeat center 2px/10px 4px;top:4px}.gg-twitter::after{width:4px;height:4px;background:currentColor;border-radius:20px;top:2px;box-shadow:7px 4px 0,7px 12px 0}</style><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),(()=>{var a="//matomo.jeaye.com/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","1"]);var e=(p=document).createElement("script"),p=p.getElementsByTagName("script")[0];e.async=!0,e.src=a+"matomo.js",p.parentNode.insertBefore(e,p)})()</script><div><div><nav class="navbar is-primary"><div class="container"><div class="navbar-brand"><a class="navbar-item title has-text-white"href="/blog"style="font-family:Comfortaa"><img src="/img/logo-transparent.png"style="margin-right:15px">jank blog</a></div><div class="navbar-menu is-active"><div class="navbar-end has-text-weight-semibold"><a class="navbar-item has-text-white"href="/"><span class="icon mr-1"><i class="gg-home"></i></span><strong>Home</strong></a><a class="navbar-item has-text-white"href="/blog"><span class="icon mr-1"><i class="gg-comment"></i></span><strong>Blog</strong></a><a class="navbar-item has-text-white"href="https://github.com/sponsors/jeaye"><span class="icon mr-1"style="color:#c96198"><i class="gg-heart"></i></span><strong>Sponsor</strong></a><a class="navbar-item has-text-white"href="https://github.com/jank-lang/jank"><span class="icon mr-1"><i class="gg-git-fork"></i></span><strong>Github</strong></a><a class="navbar-item has-text-white"href="https://clojurians.slack.com/archives/C03SRH97FDK"><span class="icon mr-1"><i class="gg-slack"></i></span>Slack</a><a class="navbar-item has-text-white"href="https://twitter.com/jeayewilkerson"><span class="icon mr-1"><i class="gg-twitter"></i></span>Twitter</a></div></div></div></nav></div><section class="section"><div class="container blog-container"><span class="is-size-1">The next phase of jank's C++ interop</span><div class="is-size-6 has-text-weight-light">Jun 06, 2025 Â· <a class="has-text-weight-normal"href="https://github.com/jeaye">Jeaye Wilkerson</a></div><hr><div class="content"><p>Two months into seamless C++ interop in jank, what sort of magic can we do now? Sit tight and I'll show you. This quarter's work is being sponsored not only by all of my individual Github sponsors, but also by Clojurists Together. Thank you for the support!<h2>Seamless interop</h2><p>As discussed in my <a href="https://jank-lang.org/blog/2025-05-02-starting-seamless-interop/">previous post</a>, I am striving to match Clojure's seamless interop with Java, but instead with C++. This involves JIT compiling C++, using Clang as a library, fitting Clang's type system into jank's, and weaving together LLVM IR generated from C++ into jank's IR.<p>jank is leveraging Clang and <a href="https://github.com/compiler-research/CppInterOp">CppInterOp</a> to make this happen and it's the first Lisp to ever achieve this seamlessness. It's also the first dynamically typed language to support AOT compilation with interleaved C++ IR, as far as I know!<h2>Tests</h2><p>Tests?! Who wants to read about those? Actually, when building something as complex as jank, especially with all of these C++ shenanigans, tests are literally the only way to have confidence in what I'm building. Last month was a mad race to prove that this whole idea can work. Fortunately, it can! But I was left with a couple thousand lines of new code, all of which had been manually tested, but I had no confidence in any of it. Before I progressed with more features this month, I added around 60 new tests, each covering a specific pass/fail case for the features introduced last month. Unsurprisingly, around half of them did not pass. Also unsurprisingly, around half of those actually crashed.<p>Getting everything into a working state took about half of this month, but now I <i>know</i> this code works. I have thought of so many ways to break it and have codified those into the test suite. Permit me, please, to share a bit about jank's testing methodologies. The most important thing is that each new test is focusing on a language feature from the user's perspective. That is to say, it's a <a href="https://en.wikipedia.org/wiki/Functional_testing">functional test</a>. I don't care very much that some <code>jank::util::helper</code> function has exhaustive unit testing. I care that the compiler works correctly when it's given good and bad source code.<p>For jank, we have a few different test suites which focus on testing in different ways.<h3>Lexer/parser (functional tests)</h3><p>We have suite of functional tests in C++ for both the lexer and the parser. For these, we feed in source and verify we get the expected tokens or objects back. They test the lexer as a whole, and the parser as a whole, rather than each of the many dozens of functions involved with either.<h3>Analysis/codegen (functional tests)</h3><p>For verifying that analysis and codegen work to catch errors and produce working code, we have a system driven by C++ which is constructed of a bunch of <code>.jank</code> files in nested directories. There's a C++ test runner which recursively finds each <code>.jank</code> file and then runs it. The files must start with either <code>pass-</code> or <code>fail-</code> (we support some others, like <code>throw-</code>, <code>warn-</code>, and <code>skip-</code>) and that dictates what result we expect. Furthermore, <code>pass-</code> files need to evaluate to <code>:success</code>. For example, we have a test <code>test/cpp/cast/pass-same-type.jank</code>:<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#fd971f">(</span><span style="color:#a6e22e">let*</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">a </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/cast</span><span style="color:#f8f8f2"> cpp/int </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/int.</span><span style="color:#ae81ff"> 4</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#f8f8f2">       b </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/cast</span><span style="color:#f8f8f2"> cpp/double </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/double.</span><span style="color:#ae81ff"> 4.0</span><span style="color:#fd971f">))]</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#fb4934;font-weight:700">if</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">and</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">=</span><span style="color:#ae81ff"> 4</span><span style="color:#f8f8f2"> a</span><span style="color:#fd971f">)</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">=</span><span style="color:#ae81ff"> 4.0</span><span style="color:#f8f8f2"> b</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#819aff">    :success</span><span style="color:#fd971f">))</span></span></code></pre><p>For all of the new C++ interop features, this is where the new tests were added.<h3>End to end (system tests)</h3><p>Outside of C++ entirely, we have a set of scripts which operate similar to the <code>.jank</code> tests where we find scripts named <code>pass-test</code> within nested directories and then invoke them. Those scripts use the <code>jank</code> binary to run files, compile modules, etc. Scripts can have setup steps to create JARs, directories, and so on. This allows us to test features like CLI usage, module paths, and AOT compilation.<h3>Miscellaneous (unit tests)</h3><p>jank does have some custom data structures, for which we have unit tests. Some analysis behavior, such as box tracking, is unit tested as well. Overall, this is a very small percentage of the tests.<h3>clojure-test-suite</h3><p>Finally, the jank community has been working on a unit test suite for <code>clojure.core</code> and other official libs, such as <code>clojure.string</code>. This is a test suite which runs for Clojure JVM, ClojureScript, and jank. The goal is for all Clojure dialects to be able to run it. Right now, we have about 20% coverage of <code>clojure.core</code> and we're looking for more contributors to help out. If you're interested, click <a href="https://github.com/jank-lang/clojure-test-suite">here</a>! All you need to know is Clojure.<p>Now, onto new features.<h2>Free functions</h2><p>Once I had ironed out all of the issues with last month's code and I had confidence in the code again, I added support for global functions. These follow the same syntax we've been using so far. You might think that global function calls are simple enough, but this is C++ we're talking about.<ol><li>Functions can be overloaded<li>Function calls can have implicit conversions for arguments<li>There exists a nasty <code>void</code> type which has no value<li>Functions can be variadic<li>Functions can be templates (and variadic templates!)<li>jank supports further implicit conversions between jank objects and native types</ol><p>Let's see how that looks by calling some C functions!<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#88846f">; Straight up C calls to seed rand.</span></span>
<span class="line"><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/srand</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/time</span><span style="color:#f8f8f2"> cpp/nullptr</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#88846f">; C call for rand, mixed with Clojure calls for mod and zero?.</span></span>
<span class="line"><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">if</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">zero?</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">mod</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/rand</span><span style="color:#fd971f">)</span><span style="color:#ae81ff"> 2</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#88846f">  ; Straight up C calls to print.</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#a6e22e">cpp/printf</span><span style="color:#e6db74"> &quot;Your name sings in my ears, Rand al'Thor.&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#a6e22e">cpp/printf</span><span style="color:#e6db74"> &quot;The Wheel weaves as the Wheel wills.&quot;</span><span style="color:#fd971f">))</span></span></code></pre><p>Oh, I also added <code>nullptr</code> support, which is a special C++ value which can implicitly convert to any pointer type.<h2>Interlude</h2><p>Hey! Are you digging the jank updates? Consider signing up for the mailing list. This is the best way to make sure you stay up to date with jank's releases, jank-related talks, workshops, and so on.<p><div style="margin:auto;text-align:center"><form action="https://listmonk.jank-lang.org/subscription/form"class="listmonk-form"method="post"target="blank_"><div><input name="nonce"type="hidden"><p><input name="email"placeholder="E-mail"required=""type="email"><p><input name="name"placeholder="Name (optional)"type="hidden"><p><input id="a132c"name="l"type="hidden"value="a132cb7d-6dc0-450c-8789-41d4fd880548"><p><button class="subscribe-button"type="submit">Subscribe</button></div></form></div><p><h2>Member functions</h2><p>Member function calls are similar to global calls, but they have an implicit <code>this</code> argument. On top of that, member functions can be overloaded based on their constness and also based on their ref-qualifier. They can also be public, protected, or private! So, in C++, you can write a member function which only gets matched when calling it from a const invoking object which is an lvalue. Tackling all of this correctly is tricky. At this point, I have most of these covered.<p>Let's see it in action.<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/raw</span><span style="color:#e6db74"> &quot;#include &lt;string&gt;&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">s </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/cast</span><span style="color:#f8f8f2"> cpp/std.string </span><span style="color:#e6db74">&quot;meow&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#f8f8f2">      size </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/.size</span><span style="color:#f8f8f2"> s</span><span style="color:#fd971f">)]</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#a6e22e">str</span><span style="color:#f8f8f2"> s </span><span style="color:#e6db74">&quot; contains &quot;</span><span style="color:#f8f8f2"> size </span><span style="color:#e6db74">&quot; bytes.&quot;</span><span style="color:#fd971f">))</span></span></code></pre><h2>Member access</h2><p>While we're reaching into members, we might as well cover the new member access support. Following Clojure's syntax, we can now use <code>(cpp/.-foo bar)</code> to effectively to the equivalent of <code>foo.bar</code> in C++. Interestingly, this will get a <em>reference</em> to the member, rather than a copy. This will ensure you're not accidentally copying things around!<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/raw</span><span style="color:#e6db74"> &quot;namespace wow_members</span></span>
<span class="line"><span style="color:#e6db74">          {</span></span>
<span class="line"><span style="color:#e6db74">            struct bar</span></span>
<span class="line"><span style="color:#e6db74">            {</span></span>
<span class="line"><span style="color:#e6db74">              int a{ 500 };</span></span>
<span class="line"><span style="color:#e6db74">            };</span></span>
<span class="line"><span style="color:#e6db74">          }&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#fd971f">(</span><span style="color:#a6e22e">let*</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">b </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/wow_members.bar.</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#88846f">       ; a is a reference to b's a, not a copy.</span></span>
<span class="line"><span style="color:#f8f8f2">       a </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/.-a</span><span style="color:#f8f8f2"> b</span><span style="color:#fd971f">)]</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#a6e22e">println</span><span style="color:#e6db74"> &quot;Wow!&quot;</span><span style="color:#f8f8f2"> a</span><span style="color:#fd971f">))</span></span></code></pre><p>This same syntax also works for accessing static members through an object! As we saw in the previous post, static members can also be accessed directly using the qualified name (i.e. <code>cpp/std.string.npos</code>).<h2>References</h2><p>Speaking of references, C++'s references are bonkers. They're just like pointers, <strong>except</strong>:<ol><li>References cannot be initialized with null (in a well-defined program)<li>References have no address of their own; the address of a reference is the address of the referred value (pointers have their own address, wherein the address of its pointee is held)<li>References use the <code>.</code> notation for member access, even though there is indirection going on<li>When passing a value as an argument to a function which takes a reference, the argument will <em>automatically</em> get its address taken</ol><p>This is so complicated to deal with, from an interop perspective. Clang, naturally, implements references as pointers, but there's nothing in the standard saying that needs to be the case. At this point, jank has pretty good coverage of all of the different scenarios, but there are still some edge cases I've identified which need fixes and tests.<h2>Operators</h2><p>Lastly, this month I tackled the myriad of C++ operators. By my count, there are <a href="https://en.cppreference.com/w/cpp/language/expressions.html#Operators">45 of them</a> for jank to support, many allowing both unary and binary usage, sometimes with incredibly different meaning.<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#88846f">; No calls to clojure.core anywhere.</span></span>
<span class="line"><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/srand</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/time</span><span style="color:#f8f8f2"> cpp/nullptr</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">if</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/==</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/int.</span><span style="color:#ae81ff"> 0</span><span style="color:#fd971f">)</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/%</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/rand</span><span style="color:#fd971f">)</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/int.</span><span style="color:#ae81ff"> 2</span><span style="color:#fd971f">)))</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#a6e22e">cpp/printf</span><span style="color:#e6db74"> &quot;Your name sings in my ears, Rand al'Thor.&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#a6e22e">cpp/printf</span><span style="color:#e6db74"> &quot;The Wheel weaves as the Wheel wills.&quot;</span><span style="color:#fd971f">))</span></span></code></pre><p>Here's one of the <code>.jank</code> tests for pointer arithmetic which shows off more operator support.<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#f8f8f2">i </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/int.</span><span style="color:#ae81ff"> 1</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#88846f">      ; p is a pointer to i.</span></span>
<span class="line"><span style="color:#f8f8f2">      p </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/&amp;</span><span style="color:#f8f8f2"> i</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#88846f">      ; We're moving forward to 4 bytes after i.</span></span>
<span class="line"><span style="color:#f8f8f2">      np </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/+</span><span style="color:#f8f8f2"> p i</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#88846f">      ; Pointer comparisons.</span></span>
<span class="line"><span style="color:#f8f8f2">      _ </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">assert</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/&lt;</span><span style="color:#f8f8f2"> p np</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#f8f8f2">      _ </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">assert</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/==</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/+</span><span style="color:#f8f8f2"> i p</span><span style="color:#fd971f">)</span><span style="color:#f8f8f2"> np</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#88846f">      ; If we move np back and deref, we get i.</span></span>
<span class="line"><span style="color:#f8f8f2">      _ </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">assert</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">=</span><span style="color:#ae81ff"> 1</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/*</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/-</span><span style="color:#f8f8f2"> np i</span><span style="color:#fd971f">))))]</span></span>
<span class="line"><span style="color:#819aff">  :success</span><span style="color:#fd971f">)</span></span></code></pre><p>Also, many (but not all) operators can be overloaded for user-defined types. Some C++ libraries use this for more expressive code.<pre class="shiki monokai"style="background-color:#272822;color:#f8f8f2"tabindex="0"><code><span class="line"><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/raw</span><span style="color:#e6db74"> &quot;struct vec2</span></span>
<span class="line"><span style="color:#e6db74">          { float x{}, y{}; };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e6db74">          vec2 operator+(vec2 const &amp;lhs, vec2 const &amp;rhs)</span></span>
<span class="line"><span style="color:#e6db74">          { return { lhs.x + rhs.x, lhs.y + rhs.y }; }&quot;</span><span style="color:#fd971f">)</span></span>
<span class="line"><span style="color:#fd971f">(</span><span style="color:#fb4934;font-weight:700">let</span><span style="color:#fd971f"> [</span><span style="color:#88846f">; Also showing off jank's new aggregate initialization support.</span></span>
<span class="line"><span style="color:#88846f">      ; No need to define constructors to be able to create aggregates.</span></span>
<span class="line"><span style="color:#f8f8f2">      s </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/vec2.</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/float.</span><span style="color:#ae81ff"> 1.0</span><span style="color:#fd971f">)</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/float.</span><span style="color:#ae81ff"> 2.0</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#f8f8f2">      b </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/vec2.</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/float.</span><span style="color:#ae81ff"> 4.0</span><span style="color:#fd971f">)</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/float.</span><span style="color:#ae81ff"> 3.0</span><span style="color:#fd971f">))</span></span>
<span class="line"><span style="color:#f8f8f2">      sb </span><span style="color:#fd971f">(</span><span style="color:#a6e22e">cpp/+</span><span style="color:#f8f8f2"> s b</span><span style="color:#fd971f">)]</span></span>
<span class="line"><span style="color:#fd971f">  (</span><span style="color:#a6e22e">println</span><span style="color:#e6db74"> &quot;s&quot;</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/.-x</span><span style="color:#f8f8f2"> s</span><span style="color:#fd971f">)</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/.-y</span><span style="color:#f8f8f2"> s</span><span style="color:#fd971f">)</span><span style="color:#e6db74"> &quot;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&quot;</span></span>
<span class="line"><span style="color:#e6db74">           &quot;b&quot;</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/.-x</span><span style="color:#f8f8f2"> b</span><span style="color:#fd971f">)</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/.-y</span><span style="color:#f8f8f2"> b</span><span style="color:#fd971f">)</span><span style="color:#e6db74"> &quot;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&quot;</span></span>
<span class="line"><span style="color:#e6db74">           &quot;sb&quot;</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/.-x</span><span style="color:#f8f8f2"> sb</span><span style="color:#fd971f">)</span><span style="color:#fd971f"> (</span><span style="color:#a6e22e">cpp/.-y</span><span style="color:#f8f8f2"> sb</span><span style="color:#fd971f">)))</span></span></code></pre><h3>Mentorship</h3><p>This month, I added a fourth mentee to the jank crew. Thanks, <a href="https://github.com/shantanu-sardesai">Shantanu</a>, for helping out on jank! These guys are all doing excellent work hacking on jank. Let me showcase their current tasks.<ul><li>Saket <a href="https://github.com/jank-lang/jank/pull/331">has a PR up</a> for the first working version of full AOT executable building<li>Monty has a working version of direct linking which will no doubt have a PR soon<li>Jianling recently added big integer support and has since been improving our IR generation for exceptions, leading up to make IR for C++ destructors easier<li>Shantanu is just getting started, but already has been improving the error handling in jank's parser</ul><p>As a mentor in partnership with the <a href="https://scicloj.github.io/docs/community/groups/open-source-mentoring/">Scicloj mentorship program</a>, I meet with each of these guys once a week, explain the inner workings of jank, Clojure, and LLVM, and do my best to give them what they need to be compiler hackers. I'm grateful for the passion they put into it.<h3>What's next?</h3><p>Two months into working on seamless interop, I'm still pleased with the progress. I don't think we'll be able to have 100% of the interop features I want done by the end of the quarter, but we'll certainly have enough to make jank very dangerous as a native Clojure. In the coming month, I still want to tackle manual memory management, better template support, ensure C++'s destructor guarantees apply to jank, stabilize the code base further with more testing, and improve portability.<p>I'll have the final seamless interop update coming out in a month, so stay tuned!<h2>Would you like to help out?</h2><ol><li>Join the community on <a href="https://clojurians.slack.com/archives/C03SRH97FDK">Slack</a><li>Join the design discussions or pick up a <code>help-wanted</code> ticket on <a href="https://github.com/jank-lang/jank">GitHub</a><li>Considering becoming a <a href="https://github.com/sponsors/jeaye">Sponsor</a> <span class="icon mr-1"style="color:#c96198"><i class="gg-heart"></i></span><li><strong>Better yet, reach out to discuss corporate sponsorship!</strong></ol><h2>Sign up!</h2><p>If you skipped out on the mailing list sign up earlier, give it a go now!<p><div style="margin:auto;text-align:center"><form action="https://listmonk.jank-lang.org/subscription/form"class="listmonk-form"method="post"target="blank_"><div><input name="nonce"type="hidden"><p><input name="email"placeholder="E-mail"required=""type="email"><p><input name="name"placeholder="Name (optional)"type="hidden"><p><input id="a132c"name="l"type="hidden"value="a132cb7d-6dc0-450c-8789-41d4fd880548"><p><button class="subscribe-button"type="submit">Subscribe</button></div></form></div><p></div></div></section></div><footer class="footer"><div class="container"><div class="columns has-text-centered"></div><div class="container has-text-centered"><div class="content is-small"><p>Â© 2025 Jeaye Wilkerson | All rights reserved.</div></div></div></footer><noscript><p><img src="//matomo.jeaye.com/matomo.php?idsite=1&amp;rec=1"style="border:0"alt=""></p></noscript><script>for(var coll=document.getElementsByClassName("collapsible"),i=0;i<coll.length;i++)coll[i].addEventListener("click",function(){this.classList.toggle("active");var l=this.nextElementSibling;"block"===l.style.display?l.style.display="none":l.style.display="block"})</script>